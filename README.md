# 프론트엔드 캔버스 에디터

안녕하세요! 이 프로젝트는 Fabric.js와 React로 만든 계층형 캔버스 에디터입니다. 부모-자식 관계를 가진 객체들을 쉽고 직관적으로 다룰 수 있어요.

## 무엇을 할 수 있나요?

- **계층형 객체**: 객체 안에 또 다른 객체를 넣고, 한 번에 같이 움직일 수 있어요.
- **2단계 선택**: 한 번 클릭하면 선택, 한 번 더 클릭하면 조작이 활성화돼요.
- **드래그 선택**: 드래그로 여러 객체를 한 번에 선택하고 바로 조작할 수 있습니다.
- **가장자리 상호작용**: 객체의 가장자리(10px 이내)에서만 선택이 가능해요.
- **경계 제한**: 자식 객체는 부모 영역을 벗어날 수 없어요.
- **실시간 피드백**: 선택하거나 조작할 때 바로바로 하이라이트가 표시돼요.

## 사용된 기술

- **React 19.1.0** with TypeScript 5.4.5
- **Fabric.js 6.7.0** 캔버스 조작용
- **fabricjs-react 2.1.0** React 통합용
- **Styled Components 6.1.19** 스타일링용
- **Vite 7.0.5** 빌드 도구
- **Bun** 패키지 매니저

## 빠르게 시작해볼까요?

### 준비물

- Node.js 16 이상 또는 Bun
- npm이나 bun 중 하나만 있으면 돼요!

### 설치 방법

1. 먼저 필요한 패키지를 설치해 주세요:
```bash
# Bun을 쓰신다면(추천)
bun install

# npm이 더 편하다면
npm install
```

2. 개발 서버를 실행해 주세요:
```bash
# Bun
bun run dev

# npm
npm run dev
```

3. 이제 브라우저에서 `http://localhost:3000`으로 들어가면 바로 시작할 수 있어요!


## 어떻게 쓰면 되나요?

### 객체 선택

#### 클릭해서 선택하기 (2단계)
1. **첫 번째 클릭**: 객체의 가장자리(10px 이내)를 클릭하면 선택돼요.
   - 두꺼운 테두리로 하이라이트됩니다.
   - 아직 리사이즈 핸들은 안 보여요.
2. **두 번째 클릭**: 이미 선택된 객체를 다시 클릭하면 조작 모드로 전환!
   - 이제 리사이즈 핸들이 나타나요.
   - 드래그로 이동도 가능합니다.

#### 드래그로 한 번에 선택하기
1. 마우스로 드래그해서 원하는 영역을 그려보세요.
2. 마우스를 놓으면, 그 안에 있는 객체 중 가장 상위 부모가 자동으로 선택돼요.
3. 선택된 객체는 바로 리사이즈 핸들이 활성화되고, 이동도 할 수 있습니다.

### 객체 계층은 이렇게!

앱에는 기본적으로 세 가지 객체가 있어요:

- **부모** (파란색, 600×500px): 제일 큰 컨테이너 역할을 해요.
- **자식** (주황색, 300×250px): 부모 안에 들어가는 두 번째 객체입니다.
- **손자** (보라색, 150×100px): 자식 객체 안에 또 들어가요.

### 이런 규칙이 있어요

- **가장자리 감지**: 객체의 가장자리 10px 이내에서만 선택이 가능합니다.
- **중앙 클릭**: 중앙을 클릭하면 드래그 선택이 시작돼요.
- **계층 존중**: 부모를 옮기면 자식들도 같이 움직여요.
- **경계 제한**: 자식은 절대 부모 영역을 벗어나지 않아요.
- **리사이즈 제한**: 부모는 자식들을 모두 담을 수 있을 만큼만 작아질 수 있습니다.

### 시각적 피드백

- **호버 효과**: 마우스를 가장자리 근처에 올리면 두꺼운 테두리가 나타나요.
- **선택 하이라이트**: 선택된 객체는 더 강조된 테두리로 보여요.
- **드래그 미리보기**: 드래그로 선택할 때, 해당 영역 내 객체들이 실시간으로 하이라이트됩니다.
- **리사이즈 핸들**: 활성 객체에는 리사이즈 컨트롤이 보입니다. (회전은 지원하지 않아요)

## 프로젝트 구조와 설계는 이렇게!

### 주요 컴포넌트

- `App.tsx`: 앱의 시작점이에요.
- `CanvasEditor.tsx`: Fabric.js와 연결되는 메인 캔버스 컴포넌트입니다.

### 커스텀 훅

- `useCanvasEvents.ts`: 마우스 이벤트와 선택 로직을 담당해요.
- `useCanvasSelection.ts`: 선택 상태, 드래그 선택을 관리합니다.
- `useCanvasObjectManipulation.ts`: 객체 이동, 리사이즈를 처리합니다.

### 유틸리티

- `canvasObjectUtils.ts`: 계층 관리와 경계 계산을 도와주는 헬퍼 함수들이에요.

### 타입 정의

- `canvas.ts`: 캔버스 객체와 상태를 위한 타입스크립트 인터페이스
- `fabric.d.ts`: Fabric.js 타입 확장 파일

## 캔버스 사양

- **크기**: 800×600 픽셀
- **좌표계**: 좌상단 원점 (0,0)
- **객체 위치**: left/top 좌표를 사용한 절대 위치
- **렌더링 순서**: 부모가 자식보다 뒤에 렌더링됩니다

## 브라우저 지원

- ES2020+ 지원하는 모던 브라우저
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 개발

### 사용 가능한 스크립트

```bash
# 개발 서버 실행
bun run dev / npm run dev

# 프로덕션 빌드
bun run build / npm run build

# 빌드 미리보기
bun run preview / npm run preview

# 코드 린팅
bun run lint / npm run lint

# 코드 포맷팅
bun run format / npm run format
```

### 프로젝트 구조

```
src/
├── components/          # React 컴포넌트
│   └── CanvasEditor.tsx # 메인 캔버스 컴포넌트
├── hooks/              # 커스텀 React 훅
│   ├── useCanvasEvents.ts
│   ├── useCanvasSelection.ts
│   └── useCanvasObjectManipulation.ts
├── types/              # TypeScript 정의
│   ├── canvas.ts
│   └── fabric.d.ts
├── utils/              # 유틸리티 함수
│   └── canvasObjectUtils.ts
└── App.tsx             # 루트 컴포넌트
```

### 주요 설계 결정

- **React 상태가 진실의 원천**: 캔버스 객체는 React 상태에서 관리되고 Fabric.js와 동기화됩니다
- **이벤트 핸들러 분리**: 다양한 상호작용 모드가 충돌을 방지하기 위해 신중하게 분리됩니다
- **성능 최적화**: 객체는 최적 렌더링을 위해 계층 깊이별로 정렬됩니다
- **타입 안전성**: 모든 캔버스 작업에 대한 포괄적인 TypeScript 커버리지
